{"version":3,"sources":["../../Scripts/app/kernel/security/empresas.manager.ts"],"names":[],"mappings":"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","file":"empresas.manager.js","sourcesContent":["//Frameworks\r\nimport { Component, ViewChild, forwardRef, Input } from '@angular/core';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { Router, ActivatedRoute } from '@angular/router';\r\nimport { Location } from '@angular/common';\r\n//Azteca Kernel\r\nimport { Context, BaseComponent, CatalogItem, CatalogService } from '../index';\r\nimport { CatalogOptions } from '../custom/index';\r\nimport { CatalogManager } from '../editors/index';\r\nimport { SearchRequest } from '../search/index';\r\n//Locales\r\nimport { EmpresaService, EmpresaInfo} from './empresa';\r\n\r\n@Component({\r\n    moduleId: module.id,\r\n    selector: 'azteca-empresas-manager',\r\n    templateUrl: './empresas.manager.html',    \r\n    providers: [\r\n        {\r\n            provide: BaseComponent, useExisting: forwardRef(() => EmpresasManager)\r\n        },\r\n        {\r\n            provide: CatalogService, useExisting: EmpresaService\r\n        }\r\n    ]\r\n})\r\nexport class EmpresasManager extends CatalogManager {\r\n    empresas: any[];    \r\n    //    \r\n\r\n    constructor(private router: Router, private route: ActivatedRoute, protected context: Context, private empresaService: EmpresaService) {\r\n        super(context);\r\n    }\r\n\r\n    onConfigureCatalog(options: CatalogOptions) {\r\n        this.manager.serverSide = options.busquedasServidor;\r\n        this.manager.pageSize = options.tamanioPagina;        \r\n        this.refreshList();\r\n    }\r\n\r\n    doSearch(request: SearchRequest) {\r\n        this.context.app.showSpinner();\r\n\r\n        this.empresaService.search(this.context.app.defaultSite.identity, request)\r\n            .then(response => {\r\n                this.context.app.hideSpinner();\r\n                //\r\n                this.empresas = response.rows;\r\n                this.totalRows = response.totalRows;\r\n                this.pageIndex = request.pageIndex;                                \r\n            })\r\n            .catch(error => this.handleError(error));\r\n    }\r\n\r\n    onAddingItem() {\r\n        this.router.navigate([0], { relativeTo: this.route });\r\n    }\r\n\r\n    onViewingItem(item: CatalogItem) {\r\n        this.router.navigate([item.id, { readonly: true }], { relativeTo: this.route });\r\n    }\r\n\r\n    onEditingItem(item: CatalogItem) {\r\n        this.router.navigate([item.id], { relativeTo: this.route });\r\n    }\r\n\r\n    onDeletingItem(item: CatalogItem) {\r\n        this.empresaService.delete(item.id)\r\n            .then(success => {\r\n                this.refreshList();\r\n                this.showAlert('El registro ha sido eliminado con éxito.', 'success');\r\n            })\r\n            .catch(error => this.handleError(error));        \r\n    }\r\n\r\n    onCloningItem(item: CatalogItem) {\r\n        this.router.navigate([0, {cloneId: item.id}], { relativeTo: this.route });\r\n    }\r\n\r\n    onChangingItemState(item: CatalogItem) {\r\n        this.empresaService.changeStatus(item.id, !item.activo)\r\n            .then(success => {\r\n                this.refreshList();\r\n                this.showAlert('El estatus del registro ha sido actualizado con éxito.', 'success');\r\n            })\r\n            .catch(error => this.handleError(error));\r\n    }\r\n\r\n}\r\n"]}